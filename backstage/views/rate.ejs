<%include components/header.ejs%>
<%include components/menu.ejs%>
		<!-- start: Content -->
		<div id="content" class="span10">


			<ul class="breadcrumb">
				<li>
					<i class="icon-home"></i>
					<a href="borrow.html">Home</a>
					<i class="icon-angle-right"></i>
				</li>
				<li>
					<i class="icon-edit"></i>
					<a href="#">值班表</a>
				</li>
			</ul>
			<div class="row-fluid sortable">
				<div class="box span12">
					<div class="box-header">
						<h2><i class="halflings-icon white align-justify"></i><span class="break"></span>值班表</h2>
					</div>
					<div class="box-content">
						<table class="table table-bordered table-striped table-condensed">
							<thead>
							<tr>
								<th>编号</th>
								<th>学号</th>
								<th>姓名</th>
								<th>联系方式</th>
							</tr>
							</thead>
                            <% if (rates.length) { %>
								<tbody>
									<% rates.forEach(function(rate,index){ %>
									<tr>
										<td><%=index+1%></td>
										<td class="center stuId" contenteditable="true"><%=rate.rateMan%></td>
										<td class="center stuName" contenteditable="true"><%=rate.rateManName%></td>
										<td class="center stuPhone" contenteditable="true"><%=rate.rateManPhone%></td>
									</tr>
									<% }) %>
								</tbody>
                            <% } %>
						</table>
						<div class="save">
							<button type="button" class="btn btn-primary saveBtn">保存</button>
							<button type="button" class="btn cancelBtn">取消</button>
						</div>
					</div>
				</div><!--/span-->
			</div><!--/row-->
		</div><!--/.fluid-container-->

		<!-- end: Content -->
	</div><!--/#content.span10-->
</div><!--/fluid-row-->

<div class="modal hide fade" id="myModal">
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal">×</button>
		<h3>Settings</h3>
	</div>
	<div class="modal-body">
		<p>Here settings can be configured...</p>
	</div>
	<div class="modal-footer">
		<a href="#" class="btn" data-dismiss="modal">Close</a>
		<a href="#" class="btn btn-primary">Save changes</a>
	</div>
</div>

<%include components/footer.ejs%>

<!-- start: JavaScript-->

<script src="js/jquery-1.9.1.min.js"></script>
<script src="js/jquery-migrate-1.0.0.min.js"></script>

<script src="js/jquery-ui-1.10.0.custom.min.js"></script>

<script src="js/jquery.ui.touch-punch.js"></script>

<script src="js/modernizr.js"></script>

<script src="js/bootstrap.min.js"></script>

<script src="js/jquery.cookie.js"></script>

<script src='js/fullcalendar.min.js'></script>

<script src='js/jquery.dataTables.min.js'></script>

<script src="js/excanvas.js"></script>
<script src="js/jquery.flot.js"></script>
<script src="js/jquery.flot.pie.js"></script>
<script src="js/jquery.flot.stack.js"></script>
<script src="js/jquery.flot.resize.min.js"></script>

<script src="js/jquery.chosen.min.js"></script>

<script src="js/jquery.uniform.min.js"></script>

<script src="js/jquery.cleditor.min.js"></script>

<script src="js/jquery.noty.js"></script>

<script src="js/jquery.elfinder.min.js"></script>

<script src="js/jquery.raty.min.js"></script>

<script src="js/jquery.iphone.toggle.js"></script>

<script src="js/jquery.uploadify-3.1.min.js"></script>

<script src="js/jquery.gritter.min.js"></script>

<script src="js/jquery.imagesloaded.js"></script>

<script src="js/jquery.masonry.min.js"></script>

<script src="js/jquery.knob.modified.js"></script>

<script src="js/jquery.sparkline.min.js"></script>

<script src="js/counter.js"></script>

<script src="js/retina.js"></script>

<script src="js/custom.js"></script>
<!-- end: JavaScript-->

</body>
</html>
<script>
    $(".save").on("click",'.saveBtn',changeRate);
//    $(".changeInfo").click(function () {
//           $(this).addClass('saveBtn');
//           $(this).removeClass('changeInfo');
//           $(this).html("保存");
//       }
//	)
    function changeRate() {
        var This=this;
        var stuIdArr=[];
        var stuNameArr=[];
        var stuPhoneArr=[];
        for(let i=0;i<$(".stuId").length;i++){
            stuIdArr[i]=$(".stuId")[i].innerHTML;
        }
        for(let j=0;j<$(".stuName").length;j++){
            stuNameArr[j]=$(".stuName")[j].innerHTML;
        }
        for(let k=0;k<$(".stuPhone").length;k++){
            stuPhoneArr[k]=$(".stuPhone")[k].innerHTML;
        }
        $.ajax({
            url: 'saveRate',
            type: 'POST',
            dataType: 'text',
            data: {'stuIdArr': stuIdArr,'stuNameArr': stuNameArr,'stuPhoneArr': stuPhoneArr},
        })
            .done(function(data) {
                if(data=="1"){
                    alert("保存成功");
                }else{
                    alert("保存失败,请刷新后重试！");
                }
            });
//        $(This).removeClass('saveBtn');
//        $(This).addClass('changeInfo');
//        $(This).html("修改");
//        $(This).off("click",changeRate);
    }
//	$(".save").on('click','.saveBtn',function () {
//        var stuIdArr=[];
//        var stuNameArr=[];
//        var stuPhoneArr=[];
//        for(let i=0;i<$(".stuId").length;i++){
//            stuIdArr[i]=$(".stuId")[i].innerHTML;
//        }
//        for(let j=0;j<$(".stuName").length;j++){
//            stuNameArr[j]=$(".stuName")[j].innerHTML;
//        }
//        for(let k=0;k<$(".stuPhone").length;k++){
//            stuPhoneArr[k]=$(".stuPhone")[k].innerHTML;
//        }
//        console.log(stuNameArr);
//        $.ajax({
//            url: 'saveRate',
//            type: 'POST',
//            dataType: 'text',
//            data: {'stuIdArr': stuIdArr,'stuNameArr': stuNameArr,'stuPhoneArr': stuPhoneArr},
//        })
//            .done(function(data) {
//                if(data=="1"){
//                    alert("保存成功");
//                }else{
//                    alert("保存失败,请刷新后重试！");
//                }
//            });
//        $(this).addClass('changeInfo');
//        $(this).removeClass('saveBtn');
//        $(this).html("修改");
//    })
//	$(".saveBtn").click();





</script>
